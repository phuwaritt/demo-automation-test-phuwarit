pipeline {
    agent { label 'bpy-agent'}
    environment {
        BASE_URL = 'http://192.8.8.133:8080/'
        PROJECT_ID = '3f9c8c76-2ecf-4502-a1bf-449ff28ff740'
        REPORT_PATH = "./testResult/output.xml"
    }
    stages {
        stage('Assign BPY 01') {
            steps {
                script{
                    sh(script: 'pabot --pabotlib --testlevelsplit --processes 3 -d testResult test-project-web-robotframework/testscripts/tc_shopping_carts_scripts.robot', returnStatus: true)
                    archiveArtifacts artifacts: 'testResult/*.html, testResult/*.jpg, testResult/*.png, testResult/*.xml', fingerprint: true, onlyIfSuccessful: false
                    robot outputPath: './testResult', otherFiles: '*.png,*.jpg', logFileName: 'log.html', outputFileName: 'output.xml', reportFileName: 'report.html'

                    common = load "$WORKSPACE/common.groovy"
                    common.result_jenkins_slack("#cicd_training_space")
                    common.result_jenkins_line()
                    common.report_sender()
                }
            }
        post{
            always{
                cleanWs()
                echo "Clear"
                }
            }
            
            }
        }
    }